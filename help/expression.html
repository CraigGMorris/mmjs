<!DOCTYPE html>
<html lang="en">
	<head>
		<meta name="viewport" content="initial-scale=1.0">
		<link rel="stylesheet" href="help.css" type="text/css">
		<script type="text/javascript" src="help.js"></script>
		<script type="text/javascript">
			window.onload = () => {
				rtSetupHeading('Expression',{
					overview: 'Overview',
					inputs: 'Inputs',
					incheck: 'Model Input Checkbox',
					displayin: 'Display Input Checkbox',
					formula: 'Formula Field',
					unit: 'Display Unit',
					format: 'Format',
					calculated: 'Calculated Value',
					table: "Table Values",
					parameters: 'Formula Parameters'
				});
			};			
		</script>	
		<title>Expression</title>
	</head>
	<body>
		<div id="page">
			<div id="heading"></div>
			<div id="menubody"></div>
			<div id="overview" class="section">
				<h3>Overview</h3>
				<p>
					An expression has a single <a href="formula.html">formula</a> representing an equation
					or constant in your calculation.
				</p>
				<p>
					For example, the expression below is named "distance" and has the formula
				</p>
				<p class="formula">
					speed * 2 h
				</p>
				<p>
					where "speed" is another expression which calculates a 5x2 matrix of
					velocities with the formula:
				</p>
				<p class="formula">
					{redim 1:10 * 10 kph, 2}
				</p>
				<img src="expression.png" alt="Expression info view"/>
				<p>
					The default unit for length when using the SI
					<a href="units.html#sets">unit set</a> is metres, but
					we can make this easier to read by tapping where it says <b>Length: m</b>
					and selecting <b>km</b> as the display unit from the resulting display. We can also add a format to
					only show one decimal place.
				</p>
				<img src="expression2.png" alt="Expression info view"/>
			</div>
			<div id="inputs" class="section">
				<h3>Inputs</h3>
				<div class="subsection">
					In addition to the <a href="infoview.html">standard name field, display check box and notes button</a>, an expression
					has:
				</div>
				<div id="incheck" class="subsection">
					<h3>Model Input Checkbox</h3>
					<p>
						When checked, this designates that the expression is considered to be an input for the
						<a href="model.html">model</a> that contains it.
					</p>
					<p>
						This means any values it references will be from the parent model, rather than the model
						that contains it (unless there is no parent model, because the expression is in
						the root model).
					</p>
				</div>
				<div id="displayin" class="subsection">
					<h3>Display Input</h3>
					<p>
						When on, an input field will appear on the <a href="model.html">information view</a>
						of the model that owns it. allowing this expressions value to be set directly from that
						view.
					</p>
				</div>
				<div id="addexpr" class="subsection">
					<h3>Add Expression (+Exp)</h3>
					<p>
						Since expressions are so commonly used, this button is provided to immediately
						add a new expression without having to go to the diagram. The icon for the new
						expression will be automatically placed on the diagram.
					</p>
				</div>
				<div id="formula" class="subsection">
					<h3>Formula Field</h3>
					<p>
						The <a href="formulaeditor.html#fields">formula field</a> has the
						<a href="formula.html">formula</a> that defines the value of the expression.
					</p>
					<p>
						Tapping the <b>â¤¢</b> symbol to the right of the field will open a
						<a href="formulaeditor.html">formula editor</a> which has helpful tools for
						composing a longer or more complex formula.
					</p>
					<p>
						Tapping on the equal sign to the left of the formula field will cause the expression
						to be reevaluated.  This is normally only pertinent for formulas using something like
						the <b>{now}</b> function, to force them to replace their cached values. It can also be used to
						regenerate error and warning dialogs resulting from the calculation.
					</p>
				</div>
				<div id="unit" class="subsection">
					<h3>Display Unit</h3>
					<p>
						Below the formula, the unit type (e.g. length) of the value calculated by the formula
						is displayed, along with the <a href="units.html">conversion unit</a>
						(e.g. m, ft etc.) to be used for displaying the value.
					</p>
					<p>
						If you wish to display the value with a different unit, tap on the unit to open a 
						<a href="formulaeditor.html#ubrowser">unit browser</a> where you can select a different one.
					</p>
					<p>
						Note that setting the display unit does not change the formula or the value it
						calculates, but merely how it is displayed. However the display unit must match
						the type of the value calculated by the formula.
					</p>
				</div>
				<div id="format" class="subsection">
					<h3>Format</h3>
					<p>
						If the expression result is a number, then there will be a format field to the right
						of the unit field. The format string is of
						the form:
					</p>
					<p class="formula">
						12.4f
					</p>
					<p>
						which says the field should be 12 characters wide with 4 characters after the
						decimal point in normal fixed point format.
					</p>
					<p>
						An <b>e</b> can be used instead of the <b>f</b> for exponential format and a
						<b>c</b> can be used for a fixed point format with commas.
					</p>
					<p>
						 You can even show numbers with an arbitrary base between 2 and 36.
						 For instance a value could be represented in hex with
						<b>14.16r</b> (or the equivalent <b>14.16x</b>).
					</p>
					<p>
						Note it is also permissable to omit the size number, i.e.
						<b>.2f</b> would be fine and the number would just be right justified.
					</p>
				</div>
				<div id="calculated" class="section">
					<h3>Calculated Value</h3>
					<p>
						The lower part of the view displays the result of the calculation as a matrix or
						table.  If the display won't fit in the window, you can scroll it both horizontally
						and vertically by dragging it. Dragging on the row or column headers will scroll
						rapidly.
					</p>
					<p>
						Tapping on a cell will show the contents of the cell in a large text area in a new
						view. For a number value this allows you to copy the value to the clipboard and if
						a format hasn't been assigned, it will be shown with high precision.
					</p>
					<p>
						For string values, which might be far larger than can
						be displayed in a cell, it allows you to see the whole string in a scrollable view
						as well as copying all or part of it to the clipboard.  Tapping the <b>Done</b>
						button on this view will return to the main view.
					</p>
				</div>
			</div>
			<div id="table" class="subsection">
				<h3>Table Values</h3>
				<p>
					If the result of evaluating the formula is a
					<a href="minionvalue.html#table">table value</a>, here defined by the formula
				</p>
				<p class="formula">
					{table "Speed", speed, "Distance", distance}
				</p>
				<p>then the unit and format fields
					 will be absent since different columns might have different units.
				</p>
				<p>
					However if you tap on the column name header in the calculated value grid, the unit
					and format fields will reappear and apply to that column.
				</p>
				<img src="tablevalue.png" alt="Expression table value"/>
				<p>
					Note that the default unit for a table value is defined by the original table
					definition.
				</p>
			</div>
			<div id="parameters" class="section">
				<h3>Formula Parameters</h3>
				<p class="reminder">
					Parameters that can be accessed in the form a.b where a is the object and b is the
					parameter.
				</p>
				<p>
					If the expression is a reference to another object, then that object's parameters will
					be available.
				</p>
				<p>
					Similarly if the result of the expression is a table value, then the table value
					column names will all be parameters.
				<p>
					Other parameters:
				</p>
				<ul>
					<li><b>table</b> - regardless of the result type, it will be returned as a table value.</li>
					<li><b>hasValue</b> - returns 1 if a value can be calculated for the expression
						formula or 0 if not.</li>
					<li><b>html</b> - a html code representation of the tool.</li>
					<li><b>notes</b> - the notes for the tool</li>
					<li><b>myname</b> - the name of the tool</li>
					<li><b>table</b> - a table representation of the value, with the column
						names just being the column numbers.
					</li>
					</ul>
			</div>
		</div>
	</body>
</html>
