<!DOCTYPE html>
<html lang="en">
	<head>
		<meta name="viewport" content="initial-scale=1.0">
		<link rel="stylesheet" href="help.css" type="text/css">
		<script type="text/javascript" src="help.js"></script>
		<script type="text/javascript">
			window.onload = () => {
				rtSetupHeading('Formula Editor',{
					fields: 'Formula Fields',
					editor: 'Formula Editor',
					vbrowser: 'Value Browser',
					ubrowser: 'Unit Browser',
					fbrowser: 'Function Browser',
				});
			};			
		</script>	
		<title>Formula Editor</title>
	</head>
	
	<body>
		<div id="page">
			<div id="heading"></div>
			<div id="fields" class="section">
				<h3>Formula Fields</h3>
				<p>
					All information views for <a href="tools.html">tools</a> have one or more
					<a href="formula.html">formula</a> fields, like this:
				</p>
				<img src="formulafield.png" alt="a formula field"/>
				<p>
					You can tap in this field and enter or edit the formula directly. Once you hit the return
					key or leave the field, the new formula will be applied and new results calculated as needed.
				</p>
				<p>
					These fields can be identified by the equal sign in front of them. Tapping on the equal
					sign will cause the value calculated by the formula to be forgotten and recalculated.  This
					normally isn't necessary as Math Minion will forget and recalculate tools whenever one of
					their inputs is modified.
				</p>
				<p>
					Directly editing a formula field is fine for simple one line formulas, but for more
					complex formulas or where you would like help with units or functions, there is a
					more elaborate formula editor that you can invoke. This is done by either typing
					shift-enter while editing the field or by tapping the <b>&#10530;</b> icon to its right.
				</p>
			</div>
			<div id="editor" class="section">
				<h3>Formula Editor</h3>
				<p>
					The formula editor consists of a large text area where the formula is
					entered or modified, along with a number of buttons and a preview area.
				</p>
				<img src="formulaedit.png" alt="formula editor"/>
				<p>
					When the formula editor appears, the current formula, if any, will appear in the text area
					with any cursor position or selection from the formula field maintained. The preview area
					will show the result of evaluating this formula.
				</p>
				<p>
					As you enter or edit the formula, you can tap the <b>Preview Button</b> or type shift-enter
					to evaluate the current formula in the preview area. If you select only a part of the formula
					before previewing, only the selected portion will be evaluated. This is a handy way to debug
					complicated formulas.
				</p>
				<p>
					Tapping the <b>Current</b> button or type alt-enter (option-enter on a Mac), will once again
					preview the original formula.
				</p>
				<p>
					In more complex formulas and with some functions, it is common to space the formula out
					over multiple lines and use tabs to improve the readability. There are a couple of features
					to assist with this.
				</p>
				<p>
					When you add a new line to an already indented line, the editor will automatically match
					the indentation.
				</p>
				<p>
					You can increase or decrease the indentation of by selecting multiple lines and then typing
					<b>tab</b> or <b>shift-tab</b> respectively.
				</p>
				<p>
					The <b>Cancel</b> button (escape key) will exit the formula editor without
					saving any of the changes. The <b>Apply</b> button <b>(shift-enter)</b> will exit the
					formula editor and any exit other than cancelling will assign the changes to the formula.
				</p>
				<p>
					The top three buttons open helper views where you can select elements to be inserted into
					the formula:
				</p>
				<div id="vbrowser" class="subsection">
					<h3>&lt;v&gt; - Value Browser (shift-ctrl-v)</h3>
					<p>	
						Shows the available tools and parameters that you can insert into the formula. When
						first invoked, the available parameters will be the tools in the current model or in the
						case of the formula belonging to an input expression, the parent
						<a href="model.html">model</a>.
					</p>
					<p>
						If you select a <a href="model.html">model</a>, then its name will appear below the
						buttons and the available parameters will be its tools.  When you select another type
						of tool, the available parameters for that tool will appear.  For instance
						the <a href="matrix.html">matrix tool</a> has parameters for the number of columns or rows it
						has.
					</p>
					<p>
						In the example below, the first selection was the <a href="model.html">model</a> named
						"circle", which contains an <a href="expression.html">expression</a> named "area".
						When area was in turn selected, it was added to the expression below the buttons.
						Tapping on <b>Insert</b> at this point would insert "circle.area" into the formula.
					</p>
					<img src="valuebrowser.png" alt="value browser"/>
				</div>
				<div id="ubrowser" class="subsection">
					<h3>"u" - Unit Browser (ctrl-u)</h3>
					<p>	
						Presents a view where you can select from the available <a href="units.html">units</a>.
						The left pane contains the defined types and selecting one of those will fill the right
						pane with the units that are defined for that type.
					</p>
					<p>
						In the image below, the type <b>Area</b> has been selected and then <b>hectare</b> was
						selected from the right pane.  This places the selected unit in the input field.
					</p>
					<img src="unitbrowser.png" alt="value browser"/>
					<p>
						Tapping the <b>Apply</b> button will insert the unit into the formula, enclosed in double
						quotes if it contains <b></b>, <b>/</b> or <b>^</b>.
					</p>
					<p>
						You aren't limited to the units listed and can create your own by combining existing
						units in the input field, either by typing them in directly, or by selecting
						them from the lists.  If you add a <b>-</b> or <b>/</b> operator to the end of the input
						field, selecting another unit will result in it being appended, rather than replacing the
						existing selection.
					</p>
					<p>
						If you need to define a completely new base unit, see custom units on the
						<a href="units.html">units</a> help page.
					</p>
					<p>
						This browser is also used for selecting display units for
						<a href="expression.html">expressions</a>,
						<a href="matrix.html">matrices</a>,
						<a href="datatable.html">data tables</a> and
						<a href="graph.html">graphs</a>.						
					</p>
				</div>
				<div id="fbrowser" class="subsection">
					<h3>{f} - Function Browser - (ctrl-f)</h3>
					<p>	
						Presents a view where you can browse the available built in Math Minion functions.
						As you can see in the image below, it has what are hopefully pretty clear
						instructions on how to use it.
					</p>
					<p>
						In this case the section for trigonometric functions has been selected and then the
						sine function within it.
					</p>
					<img src="funcbrowser.png" alt="value browser"/>
				</div>
			</div>
		</div>
	</body>
</html>
